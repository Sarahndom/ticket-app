{% extends "base.twig" %}
{% block content %}
{# Protect the page #}
<script>
  if (localStorage.getItem('ticketapp_session') === null) {
    alert("Your session has expired â€” please log in again.");
    window.location.href = 'login.php';
  }
</script>

<main class="container">
  {# Store the ticket ID from PHP in a hidden way for JavaScript #}
  <input type="hidden" id="ticket-id" value="{{ ticket_id }}">

  <div class="form-container" style="max-width: 700px; margin: 2rem auto;">
    <form id="edit-ticket-form"> {# ID for JavaScript #}
      <h2 style="margin-bottom: 1.5rem;">Edit Ticket #{{ ticket_id }}</h2>

      <p id="error-message" class="error-inline" style="margin-bottom: 1rem;"></p>

      <div class="form-group">
        <label for="title">Title (Mandatory)</label>
        <input type="text" id="title" class="form-control" required/>
        <p id="error-title" class="error-inline"></p>
      </div>

      <div class="form-group">
        <label for="status">Status (Mandatory)</label>
        <select id="status" class="form-control" required>
          <option value="open">Open</option>
          <option value="in_progress">In Progress</option>
          <option value="closed">Closed</option>
        </select>
        <p id="error-status" class="error-inline"></p>
      </div>

      <div class="form-group">
        <label for="priority">Priority (Optional)</label>
        <select id="priority" class="form-control">
          <option value="low">Low</option>
          <option value="medium">Medium</option>
          <option value="high">High</option>
        </select>
      </div>

      <div class="form-group">
        <label for="description">Description (Optional)</label>
        <textarea id="description" class="form-control"></textarea>
      </div>

      <div style="display: flex; gap: 1rem;">
          <button type="submit" class="btn btn-primary">Save Changes</button>
          <a href="tickets.php" class="btn btn-secondary">Cancel</a>
      </div>
    </form>
  </div>
</main>
{% endblock %}